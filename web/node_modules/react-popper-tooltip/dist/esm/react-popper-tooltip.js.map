{"version":3,"file":"react-popper-tooltip.js","sources":["../../src/utils.ts","../../src/Tooltip.tsx","../../src/TooltipTrigger.tsx"],"sourcesContent":["import React from 'react';\nimport { Ref } from './types';\n\nexport const TooltipContext = React.createContext({});\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype Fn = ((...args: any[]) => void) | undefined;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const callAll = (...fns: Fn[]) => (...args: any[]) =>\n  fns.forEach((fn) => fn && fn(...args));\n\nexport const noop = () => {\n  // do nothing\n};\n\nexport const canUseDOM = () =>\n  !!(\n    typeof window !== 'undefined' &&\n    window.document &&\n    window.document.createElement\n  );\n\nexport const setRef = (ref: Ref, node: HTMLElement | null) => {\n  if (typeof ref === 'function') {\n    return ref(node);\n  } else if (ref != null) {\n    ref.current = node;\n  }\n};\n","import React, { Component } from 'react';\nimport {\n  GetArrowPropsArg,\n  GetTooltipPropsArg,\n  TooltipProps,\n  TriggerTypes,\n} from './types';\nimport { callAll, TooltipContext, setRef } from './utils';\n\nclass Tooltip extends Component<TooltipProps> {\n  public static contextType = TooltipContext;\n\n  private observer?: MutationObserver;\n  private tooltipRef!: HTMLElement | null;\n\n  public componentDidMount() {\n    const observer = (this.observer = new MutationObserver(() => {\n      this.props.scheduleUpdate();\n    }));\n    observer.observe(this.tooltipRef!, this.props.mutationObserverOptions);\n\n    if (\n      this.isTriggeredBy('hover') ||\n      this.isTriggeredBy('click') ||\n      this.isTriggeredBy('right-click')\n    ) {\n      const {\n        removeParentOutsideClickHandler,\n        removeParentOutsideRightClickHandler,\n      } = this.context;\n      this.addOutsideClickHandler();\n      this.addOutsideRightClickHandler();\n      if (removeParentOutsideClickHandler) {\n        removeParentOutsideClickHandler();\n      }\n      if (removeParentOutsideRightClickHandler) {\n        removeParentOutsideRightClickHandler();\n      }\n    }\n  }\n\n  public componentDidUpdate() {\n    if (this.props.closeOnOutOfBoundaries && this.props.outOfBoundaries) {\n      this.props.hideTooltip();\n    }\n  }\n\n  public componentWillUnmount() {\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n\n    if (\n      this.isTriggeredBy('hover') ||\n      this.isTriggeredBy('click') ||\n      this.isTriggeredBy('right-click')\n    ) {\n      const {\n        isParentNoneTriggered,\n        addParentOutsideClickHandler,\n        addParentOutsideRightClickHandler,\n      } = this.context;\n      this.removeOutsideClickHandler();\n      this.removeOutsideRightClickHandler();\n      this.handleOutsideClick = undefined;\n      this.handleOutsideRightClick = undefined;\n      if (!isParentNoneTriggered && addParentOutsideClickHandler) {\n        addParentOutsideClickHandler();\n      }\n      if (!isParentNoneTriggered && addParentOutsideRightClickHandler) {\n        addParentOutsideRightClickHandler();\n      }\n    }\n  }\n\n  public render() {\n    const { arrowProps, placement, tooltip } = this.props;\n\n    return (\n      <TooltipContext.Provider value={this.contextValue}>\n        {tooltip({\n          arrowRef: arrowProps.ref,\n          getArrowProps: this.getArrowProps,\n          getTooltipProps: this.getTooltipProps,\n          placement,\n          tooltipRef: this.getTooltipRef,\n        })}\n      </TooltipContext.Provider>\n    );\n  }\n\n  private isTriggeredBy(event: TriggerTypes) {\n    const { trigger } = this.props;\n    return (\n      trigger === event || (Array.isArray(trigger) && trigger.includes(event))\n    );\n  }\n\n  private handleOutsideClick?: EventListener = (event) => {\n    if (this.tooltipRef && !this.tooltipRef.contains(event.target as Node)) {\n      const { parentOutsideClickHandler } = this.context;\n      const { hideTooltip, clearScheduled } = this.props;\n\n      clearScheduled();\n      hideTooltip();\n      if (parentOutsideClickHandler) {\n        parentOutsideClickHandler(event);\n      }\n    }\n  };\n\n  private handleOutsideRightClick?: EventListener = (event) => {\n    if (this.tooltipRef && !this.tooltipRef.contains(event.target as Node)) {\n      const { parentOutsideRightClickHandler } = this.context;\n      const { hideTooltip, clearScheduled } = this.props;\n\n      clearScheduled();\n      hideTooltip();\n      if (parentOutsideRightClickHandler) {\n        parentOutsideRightClickHandler(event);\n      }\n    }\n  };\n\n  private addOutsideClickHandler = () => {\n    document.body.addEventListener('touchend', this.handleOutsideClick!);\n    document.body.addEventListener('click', this.handleOutsideClick!);\n  };\n\n  private removeOutsideClickHandler = () => {\n    document.body.removeEventListener('touchend', this.handleOutsideClick!);\n    document.body.removeEventListener('click', this.handleOutsideClick!);\n  };\n\n  private addOutsideRightClickHandler = () =>\n    document.body.addEventListener(\n      'contextmenu',\n      this.handleOutsideRightClick!\n    );\n\n  private removeOutsideRightClickHandler = () =>\n    document.body.removeEventListener(\n      'contextmenu',\n      this.handleOutsideRightClick!\n    );\n\n  private getTooltipRef = (node: HTMLElement | null) => {\n    this.tooltipRef = node;\n    setRef(this.props.innerRef, node);\n  };\n\n  private getArrowProps = (props: GetArrowPropsArg = {}) => ({\n    ...props,\n    style: { ...props.style, ...this.props.arrowProps.style },\n  });\n\n  private getTooltipProps = (props: GetTooltipPropsArg = {}) => ({\n    ...props,\n    ...(this.isTriggeredBy('hover') && {\n      onMouseEnter: callAll(this.props.clearScheduled, props.onMouseEnter),\n      onMouseLeave: callAll(this.props.hideTooltip, props.onMouseLeave),\n    }),\n    style: { ...props.style, ...this.props.style },\n  });\n\n  private contextValue = {\n    isParentNoneTriggered: this.props.trigger === 'none',\n    addParentOutsideClickHandler: this.addOutsideClickHandler,\n    addParentOutsideRightClickHandler: this.addOutsideRightClickHandler,\n    parentOutsideClickHandler: this.handleOutsideClick,\n    parentOutsideRightClickHandler: this.handleOutsideRightClick,\n    removeParentOutsideClickHandler: this.removeOutsideClickHandler,\n    removeParentOutsideRightClickHandler: this.removeOutsideRightClickHandler,\n  };\n}\n\nexport default Tooltip;\n","/**\n * @author Mohsin Ul Haq <mohsinulhaq01@gmail.com>\n */\nimport PopperJS from 'popper.js';\nimport React, { Component } from 'react';\nimport { createPortal } from 'react-dom';\nimport { Manager, Popper, Reference } from 'react-popper';\nimport Tooltip from './Tooltip';\nimport {\n  GetTriggerPropsArg,\n  TooltipTriggerProps,\n  TooltipTriggerState,\n  TriggerTypes,\n} from './types';\nimport { callAll, canUseDOM, noop } from './utils';\n\nconst DEFAULT_MODIFIERS: PopperJS.Modifiers = {\n  preventOverflow: {\n    boundariesElement: 'viewport',\n  },\n};\n\nconst DEFAULT_MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  childList: true,\n  subtree: true,\n};\n\nclass TooltipTrigger extends Component<\n  TooltipTriggerProps,\n  TooltipTriggerState\n> {\n  public static defaultProps = {\n    closeOnOutOfBoundaries: true,\n    defaultTooltipShown: false,\n    delayHide: 0,\n    delayShow: 0,\n    followCursor: false,\n    onVisibilityChange: noop,\n    placement: 'right',\n    portalContainer: canUseDOM() ? document.body : null,\n    trigger: 'hover',\n    usePortal: canUseDOM(),\n    mutationObserverOptions: DEFAULT_MUTATION_OBSERVER_CONFIG,\n  };\n\n  public state: TooltipTriggerState = {\n    tooltipShown: this.props.defaultTooltipShown,\n  };\n\n  private hideTimeout?: number;\n  private showTimeout?: number;\n  private popperOffset?: PopperJS.Offset;\n\n  public componentWillUnmount() {\n    this.clearScheduled();\n  }\n\n  public render() {\n    const {\n      children,\n      tooltip,\n      placement,\n      trigger,\n      getTriggerRef,\n      modifiers,\n      closeOnOutOfBoundaries,\n      usePortal,\n      portalContainer,\n      followCursor,\n      getTooltipRef,\n      mutationObserverOptions,\n      ...restProps\n    } = this.props;\n\n    const popper = (\n      <Popper\n        innerRef={getTooltipRef}\n        placement={placement}\n        modifiers={{\n          ...DEFAULT_MODIFIERS,\n          ...(followCursor && {\n            followCursorModifier: {\n              enabled: true,\n              fn: (data) => {\n                this.popperOffset = data.offsets.popper;\n                return data;\n              },\n              order: 1000,\n            },\n          }),\n          ...modifiers,\n        }}\n        {...restProps}\n      >\n        {({\n          ref,\n          style,\n          // tslint:disable-next-line\n          placement,\n          arrowProps,\n          outOfBoundaries,\n          scheduleUpdate,\n        }) => {\n          if (followCursor && this.popperOffset) {\n            const { pageX, pageY } = this.state;\n            const { width, height } = this.popperOffset;\n            const x =\n              pageX! + width > window.scrollX + document.body.offsetWidth\n                ? pageX! - width\n                : pageX;\n            const y =\n              pageY! + height > window.scrollY + document.body.offsetHeight\n                ? pageY! - height\n                : pageY;\n            style.transform = `translate3d(${x}px, ${y}px, 0`;\n          }\n\n          return (\n            <Tooltip\n              {...{\n                arrowProps,\n                closeOnOutOfBoundaries,\n                outOfBoundaries,\n                placement,\n                scheduleUpdate,\n                style,\n                tooltip,\n                trigger,\n                mutationObserverOptions,\n              }}\n              clearScheduled={this.clearScheduled}\n              hideTooltip={this.hideTooltip}\n              innerRef={ref}\n            />\n          );\n        }}\n      </Popper>\n    );\n\n    return (\n      <Manager>\n        <Reference innerRef={getTriggerRef}>\n          {({ ref }) =>\n            children({ getTriggerProps: this.getTriggerProps, triggerRef: ref })\n          }\n        </Reference>\n        {this.getState() &&\n          (usePortal ? createPortal(popper, portalContainer) : popper)}\n      </Manager>\n    );\n  }\n\n  private isControlled() {\n    return this.props.tooltipShown !== undefined;\n  }\n\n  private getState() {\n    return this.isControlled()\n      ? this.props.tooltipShown\n      : this.state.tooltipShown;\n  }\n\n  private setTooltipState = (state: TooltipTriggerState) => {\n    const cb = () => this.props.onVisibilityChange(state.tooltipShown);\n    this.isControlled() ? cb() : this.setState(state, cb);\n  };\n\n  private clearScheduled = () => {\n    clearTimeout(this.hideTimeout);\n    clearTimeout(this.showTimeout);\n  };\n\n  private showTooltip = ({\n    pageX,\n    pageY,\n  }: {\n    pageX: number;\n    pageY: number;\n  }) => {\n    this.clearScheduled();\n    let state: TooltipTriggerState = {\n      tooltipShown: true,\n    };\n    if (this.props.followCursor) {\n      state = {\n        ...state,\n        pageX,\n        pageY,\n      };\n    }\n    this.showTimeout = window.setTimeout(\n      () => this.setTooltipState(state),\n      this.props.delayShow\n    );\n  };\n\n  private hideTooltip = () => {\n    this.clearScheduled();\n    this.hideTimeout = window.setTimeout(\n      () => this.setTooltipState({ tooltipShown: false }),\n      this.props.delayHide\n    );\n  };\n\n  private toggleTooltip = ({\n    pageX,\n    pageY,\n  }: {\n    pageX: number;\n    pageY: number;\n  }) => {\n    const action = this.getState() ? 'hideTooltip' : 'showTooltip';\n    this[action]({ pageX, pageY });\n  };\n\n  private clickToggle: React.MouseEventHandler = (event: React.MouseEvent) => {\n    event.preventDefault();\n    const { pageX, pageY } = event;\n    const action = this.props.followCursor ? 'showTooltip' : 'toggleTooltip';\n    this[action]({ pageX, pageY });\n  };\n\n  private contextMenuToggle: React.MouseEventHandler = (event) => {\n    event.preventDefault();\n    const { pageX, pageY } = event;\n    const action = this.props.followCursor ? 'showTooltip' : 'toggleTooltip';\n    this[action]({ pageX, pageY });\n  };\n\n  private isTriggeredBy(event: TriggerTypes) {\n    const { trigger } = this.props;\n    return (\n      trigger === event || (Array.isArray(trigger) && trigger.includes(event))\n    );\n  }\n\n  private getTriggerProps = (props: GetTriggerPropsArg = {}) => {\n    return {\n      ...props,\n      ...(this.isTriggeredBy('click') && {\n        onClick: callAll(this.clickToggle, props.onClick),\n        onTouchEnd: callAll(this.clickToggle, props.onTouchEnd),\n      }),\n      ...(this.isTriggeredBy('right-click') && {\n        onContextMenu: callAll(this.contextMenuToggle, props.onContextMenu),\n      }),\n      ...(this.isTriggeredBy('hover') && {\n        onMouseEnter: callAll(this.showTooltip, props.onMouseEnter),\n        onMouseLeave: callAll(this.hideTooltip, props.onMouseLeave),\n        ...(this.props.followCursor && {\n          onMouseMove: callAll(this.showTooltip, props.onMouseMove),\n        }),\n      }),\n      ...(this.isTriggeredBy('focus') && {\n        onFocus: callAll(this.showTooltip, props.onFocus),\n        onBlur: callAll(this.hideTooltip, props.onBlur),\n      }),\n    };\n  };\n}\n\nexport default TooltipTrigger;\n"],"names":["TooltipContext","React","createContext","callAll","fns","args","forEach","fn","noop","canUseDOM","window","document","createElement","setRef","ref","node","current","Tooltip","observer","tooltipRef","handleOutsideClick","event","contains","target","parentOutsideClickHandler","context","props","hideTooltip","clearScheduled","handleOutsideRightClick","parentOutsideRightClickHandler","addOutsideClickHandler","body","addEventListener","removeOutsideClickHandler","removeEventListener","addOutsideRightClickHandler","removeOutsideRightClickHandler","getTooltipRef","innerRef","getArrowProps","style","arrowProps","getTooltipProps","isTriggeredBy","onMouseEnter","onMouseLeave","contextValue","isParentNoneTriggered","trigger","addParentOutsideClickHandler","addParentOutsideRightClickHandler","removeParentOutsideClickHandler","removeParentOutsideRightClickHandler","componentDidMount","MutationObserver","scheduleUpdate","observe","mutationObserverOptions","componentDidUpdate","closeOnOutOfBoundaries","outOfBoundaries","componentWillUnmount","disconnect","undefined","render","placement","tooltip","arrowRef","Array","isArray","includes","Component","contextType","DEFAULT_MODIFIERS","preventOverflow","boundariesElement","DEFAULT_MUTATION_OBSERVER_CONFIG","childList","subtree","TooltipTrigger","state","tooltipShown","defaultTooltipShown","hideTimeout","showTimeout","popperOffset","setTooltipState","cb","onVisibilityChange","isControlled","setState","clearTimeout","showTooltip","pageX","pageY","followCursor","setTimeout","delayShow","delayHide","toggleTooltip","action","getState","clickToggle","preventDefault","contextMenuToggle","getTriggerProps","onClick","onTouchEnd","onContextMenu","onMouseMove","onFocus","onBlur","children","getTriggerRef","modifiers","usePortal","portalContainer","restProps","popper","followCursorModifier","enabled","data","offsets","order","width","height","x","scrollX","offsetWidth","y","scrollY","offsetHeight","transform","triggerRef","createPortal","defaultProps"],"mappings":"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"}